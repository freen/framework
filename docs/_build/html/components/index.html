


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Components &mdash; FMF 1.0 documentation</title>
  

  
  

  
  <link rel="stylesheet" href="../_static/sphinx_rtd_theme.css" type="text/css" />
      

      
  
  
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:'../',
        VERSION:'1.0',
        COLLAPSE_INDEX:false,
        FILE_SUFFIX:'.html',
        HAS_SOURCE:  true
      };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/sphinx_rtd_theme.js"></script>
    
    

  
    <link rel="top" title="FMF 1.0 documentation" href="../index.html"/>
        <link rel="next" title="Theming" href="../theming/index.html"/>
        <link rel="prev" title="Folder Structure" href="../folder/index.html"/> 

  
  
    <script type="text/javascript" src="//use.typekit.net/hiw1hhg.js"></script>
    <script type="text/javascript">try{Typekit.load();}catch(e){}</script>
  
  <script src="//cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

  <div class="wy-grid-for-nav">
    
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="../index.html">PHP Federated Micro-Framework</a>
        <form class="wy-form" action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search docs" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix">
        <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../quickstart/index.html">Quick Start Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../quickstart/index.html#obtain-run-virtual-server">Obtain &amp; Run Virtual Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart/index.html#existing-project-git-pull-the-project-to-the-shared-drive">Existing Project: git pull the Project to the Shared Drive</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart/index.html#new-project-build-from-scratch">New Project: Build from Scratch</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart/index.html#compose-project-or-download-vendors-folder">Compose Project Or Download Vendors Folder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart/index.html#import-project-data">Import Project Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart/index.html#verify-in-web-browser">Verify in Web Browser</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart/index.html#write-code">Write Code</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../setup/index.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../setup/index.html#system-requirements">System Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../setup/index.html#creating-a-project">Creating A Project</a></li>
<li class="toctree-l2"><a class="reference internal" href="../setup/index.html#web-servers">Web Servers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../setup/index.html#windows">Windows</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../concepts/index.html">Concepts</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../concepts/index.html#build-and-re-build">Build and Re-Build</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/index.html#auto-generated-routes">Auto-Generated Routes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/index.html#api-centric">API Centric</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/index.html#service-oriented-architecture">Service Oriented Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/index.html#less-logic-templates">Less-Logic Templates</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/index.html#pubsub-pattern">PubSub Pattern</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/index.html#no-sql">No-SQL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/index.html#search">Search</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/index.html#queues">Queues</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../folder/index.html">Folder Structure</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../folder/index.html#app">app</a></li>
<li class="toctree-l2"><a class="reference internal" href="../folder/index.html#collections">collections</a></li>
<li class="toctree-l2"><a class="reference internal" href="../folder/index.html#config">config</a></li>
<li class="toctree-l2"><a class="reference internal" href="../folder/index.html#filters">filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../folder/index.html#forms">forms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../folder/index.html#public">public</a></li>
<li class="toctree-l2"><a class="reference internal" href="../folder/index.html#subscribers">subscribers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../folder/index.html#vendors">vendors</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Components</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#collection">Collection</a></li>
<li class="toctree-l2"><a class="reference internal" href="#form">Form</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pubsub">PubSub</a></li>
<li class="toctree-l2"><a class="reference internal" href="#separation">Separation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../theming/index.html">Theming</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../theming/index.html#sample-project">Sample Project</a></li>
<li class="toctree-l2"><a class="reference internal" href="../theming/index.html#listing-auto-generated-routes">Listing Auto-Generated Routes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../theming/index.html#types-of-pages">Types of Pages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../theming/index.html#working-with-layouts">Working with Layouts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../theming/index.html#working-with-partials">Working with Partials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../theming/index.html#separation-applications">Separation Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../theming/index.html#best-practices">Best Practices</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../bundles/index.html">Bundles</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appliance/index.html">Server Appliance</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../appliance/index.html#installing-virtualbox">Installing VirtualBox</a></li>
<li class="toctree-l2"><a class="reference internal" href="../appliance/index.html#obtaining-the-appliance">Obtaining the Appliance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../appliance/index.html#using-the-appliance">Using the Appliance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../appliance/index.html#shared-drive">Shared Drive</a></li>
<li class="toctree-l2"><a class="reference internal" href="../appliance/index.html#demo-project">Demo Project</a></li>
<li class="toctree-l2"><a class="reference internal" href="../appliance/index.html#new-project">New Project</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../separation/index.html">Separation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../separation/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../separation/index.html#a-sample-configuration-file">A Sample Configuration File</a></li>
</ul>
</li>
</ul>

      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top">
        <i data-toggle="wy-nav-top" class="icon icon-reorder"></i>
        <a href="/">FMF 1.0 documentation</a>        
      </nav>
      
      
      <div class="wy-nav-content">
        <div class="rst-content">
          <script type="text/javascript">var switchTo5x=true;</script>
<script type="text/javascript" src="http://w.sharethis.com/button/buttons.js"></script>
<script type="text/javascript">stLight.options({publisher: "437da74a-28a4-47ae-84fd-958107b69e59", doNotHash: false, doNotCopy: false, hashAddressBar: false});</script>
<ul class="wy-breadcrumbs">
  <li><a href="/">Docs</a> &raquo;</li>
  <li><a href="">Components</a></li>
  

  	<li class="wy-breadcrumbs-aside"><span class='st_email_large' displayText='Email'></span></li>
	<li class="wy-breadcrumbs-aside"><span class='st_linkedin_large' displayText='LinkedIn'></span></li>
	<li class="wy-breadcrumbs-aside"><span class='st_googleplus_large' displayText='Google +'></span></li>
	<li class="wy-breadcrumbs-aside"><span class='st_twitter_large' displayText='Tweet'></span></li>
	<li class="wy-breadcrumbs-aside" style="margin-left: 20px"><span class='st_facebook_large' displayText='Facebook'></span></li>
<li class="wy-breadcrumbs-aside">
      <a href="https://github.com///edit/components/index.rst" class="icon icon-github"> Edit on GitHub</a>
    </li>
</ul>
<hr/>
          
  <div class="section" id="components">
<h1>Components<a class="headerlink" href="#components" title="Permalink to this headline">¶</a></h1>
<div class="section" id="collection">
<span id="id1"></span><h2>Collection<a class="headerlink" href="#collection" title="Permalink to this headline">¶</a></h2>
<p>Fork on github here: <a class="reference external" href="https://github.com/virtuecenter/collection">collection source</a></p>
<p>Collections are at the heart of how FMF makes data accessable.  FMF will create RESTful APIs that produce JSON data, as well as front-end routes for collection data on a website front-end.</p>
<p>Collection files are typically small, but they may contain logic for transforming individual documents returned:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>
<span class="k">use</span> <span class="nx">UrlId\UrlId</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">videos</span> <span class="p">{</span>
        <span class="k">use</span> <span class="nx">Collection\Collection</span><span class="p">;</span>
        <span class="k">public</span> <span class="nv">$publishable</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
        <span class="k">public</span> <span class="nv">$singular</span> <span class="o">=</span> <span class="s1">&#39;video&#39;</span><span class="p">;</span>

        <span class="k">public</span> <span class="k">function</span> <span class="nf">document</span> <span class="p">(</span><span class="o">&amp;</span><span class="nv">$document</span><span class="p">)</span> <span class="p">{</span>
                <span class="nv">$document</span><span class="p">[</span><span class="s1">&#39;video_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">null</span><span class="p">;</span>
                <span class="nv">$document</span><span class="p">[</span><span class="s1">&#39;video_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">null</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$document</span><span class="p">[</span><span class="s1">&#39;video&#39;</span><span class="p">]))</span> <span class="p">{</span>
                        <span class="nv">$document</span><span class="p">[</span><span class="s1">&#39;video_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">UrlId</span><span class="o">::</span><span class="na">parse</span><span class="p">(</span><span class="nv">$document</span><span class="p">[</span><span class="s1">&#39;video&#39;</span><span class="p">],</span> <span class="nv">$document</span><span class="p">[</span><span class="s1">&#39;video_type&#39;</span><span class="p">]);</span>
                <span class="p">}</span>
                <span class="nv">$document</span><span class="p">[</span><span class="s1">&#39;category_titles&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[];</span>
                <span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$document</span><span class="p">[</span><span class="s1">&#39;categories&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nb">is_array</span><span class="p">(</span><span class="nv">$document</span><span class="p">[</span><span class="s1">&#39;categories&#39;</span><span class="p">]))</span> <span class="p">{</span>
                        <span class="k">foreach</span> <span class="p">(</span><span class="nv">$document</span><span class="p">[</span><span class="s1">&#39;categories&#39;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$id</span><span class="p">)</span> <span class="p">{</span>
                                <span class="nv">$category</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">collection</span><span class="p">(</span><span class="s1">&#39;categories&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">findOne</span><span class="p">([</span><span class="s1">&#39;_id&#39;</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">id</span><span class="p">(</span><span class="nv">$id</span><span class="p">)],</span> <span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]);</span>
                                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$category</span><span class="p">[</span><span class="s1">&#39;_id&#39;</span><span class="p">]))</span> <span class="p">{</span>
                                        <span class="k">continue</span><span class="p">;</span>
                                <span class="p">}</span>
                                <span class="nv">$document</span><span class="p">[</span><span class="s1">&#39;category_titles&#39;</span><span class="p">][]</span> <span class="o">=</span> <span class="nv">$category</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">];</span>
                        <span class="p">}</span>
                <span class="p">}</span>
        <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<hr class="docutils" />
<p>An example of the result of a collection can be found here: <a class="reference external" href="http://json.virtuecenter.com/json-data/blogs/all?pretty">Blogs Collection API</a></p>
<p>Collection APIs are handy, because you can see the field layout easily in JSON:</p>
<div class="highlight-json"><pre>{
    "blogs": [
        {
            "_id": "50490cb9b79921001200000b",
            "body": "&lt;p&gt;Article Content&lt;/p&gt;",
            "code_name": "naacp_calls_for_an_end_to_birmingham_police_using_pepper_spray_in_schools",
            "comments": "t",
            "description": "Some Descriptive Text"",
            "display_date": {
                "sec": 1346126400,
                "usec": 0
            },
            "featured": "f",
            "image": {
                "name": "us-davis-pepper-spray.jpg",
                "size": "411507",
                "type": "image/jpeg",
                "url": "http://virtuecenter.s3.amazonaws.com/files/2012-09-06-16/us-davis-pepper-spray.jpg",
                "height": "453",
                "width": "680"
            },
            "pinned": "f",
            "status": "published",
            "tags": [],
            "title": "NAACP calls for an end to Birmingham police using pepper spray in schools",
            "display_date__MdY": "Aug 28, 2012",
            "path": "/blog/naacp_calls_for_an_end_to_birmingham_police_using_pepper_spray_in_schools.html"
        }
    ],
    "pagination": {
        "limit": 20,
        "total": 1,
        "page": 1,
        "pageCount": 1
    }
}</pre>
</div>
<hr class="docutils" />
<p>The API for working with collection data is restul and follows the follwing format:</p>
<p><a class="reference external" href="http://website.com/json-date/collection/method/limit/page/sortjson">http://website.com/json-date/collection/method/limit/page/sortjson</a></p>
<p>For example:</p>
<p><a class="reference external" href="http://json.virtuecenter.com/json-data/blogs/all/5/0">http://json.virtuecenter.com/json-data/blogs/all/5/0</a>/{&#8220;display_date&#8221;:-1}</p>
<p>The API has many built in methods:</p>
<ul class="simple">
<li>all</li>
<li>byAuthorId</li>
<li>byAuthor</li>
<li>byCategory</li>
<li>byCategoryFeatured</li>
<li>byCategoryId</li>
<li>byCategoryIdFeatured</li>
<li>byDatePast</li>
<li>byDateUpcoming</li>
<li>byId</li>
<li>bySlug</li>
<li>byTag</li>
<li>byTagFeatured</li>
<li>featured</li>
<li>popular</li>
</ul>
<p>To use a method that takes and argument, hyphenate the argument with the method, for example:</p>
<p><a class="reference external" href="http://json.virtuecenter.com/json-data/blogs/byTag-GovernorBentley">http://json.virtuecenter.com/json-data/blogs/byTag-GovernorBentley</a></p>
<hr class="docutils" />
</div>
<div class="section" id="form">
<h2>Form<a class="headerlink" href="#form" title="Permalink to this headline">¶</a></h2>
<p>Fork on github here: <a class="reference external" href="https://github.com/virtuecenter/form">form source</a></p>
<p>The Form component is a very advanced form generator that supports rendering a wide variety of field types in a very flexible way.</p>
<p>It is intended to be used with <a class="reference external" href="http://semantic-ui.com/collections/form.html">Semantic UI Form Collection</a></p>
<p>An individual form class looks like this:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>
<span class="k">class</span> <span class="nc">contact</span> <span class="p">{</span>
        <span class="k">public</span> <span class="k">function</span> <span class="nf">__construct</span> <span class="p">(</span><span class="nv">$field</span><span class="p">)</span> <span class="p">{</span>
                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">field</span> <span class="o">=</span> <span class="nv">$field</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">public</span> <span class="nv">$storage</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s1">&#39;collection&#39;</span>    <span class="o">=&gt;</span> <span class="s1">&#39;contacts&#39;</span><span class="p">,</span>
                <span class="s1">&#39;key&#39;</span>                   <span class="o">=&gt;</span> <span class="s1">&#39;_id&#39;</span>
        <span class="p">];</span>
        <span class="k">public</span> <span class="nv">$after</span> <span class="o">=</span> <span class="s1">&#39;notice&#39;</span><span class="p">;</span>
        <span class="k">public</span> <span class="nv">$notice</span> <span class="o">=</span> <span class="s1">&#39;Your contact request has been received&#39;</span><span class="p">;</span>
        <span class="k">public</span> <span class="nv">$noticeDetails</span> <span class="o">=</span> <span class="s1">&#39;We will be in touch soon.&#39;</span><span class="p">;</span>

        <span class="k">function</span> <span class="nf">first_nameField</span><span class="p">()</span> <span class="p">{</span>
                <span class="k">return</span> <span class="p">[</span>
                        <span class="s1">&#39;name&#39;</span>          <span class="o">=&gt;</span> <span class="s1">&#39;first_name&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;placeholder&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;First Name&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;display&#39;</span>       <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">field</span><span class="o">-&gt;</span><span class="na">inputText</span><span class="p">(),</span>
                        <span class="s1">&#39;required&#39;</span>      <span class="o">=&gt;</span> <span class="k">true</span>
                <span class="p">];</span>
        <span class="p">}</span>

        <span class="k">function</span> <span class="nf">last_nameField</span><span class="p">()</span> <span class="p">{</span>
                <span class="k">return</span> <span class="p">[</span>
                        <span class="s1">&#39;name&#39;</span>          <span class="o">=&gt;</span> <span class="s1">&#39;last_name&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;placeholder&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Last Name&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;label&#39;</span>         <span class="o">=&gt;</span> <span class="s1">&#39;Last Name&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;display&#39;</span>       <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">field</span><span class="o">-&gt;</span><span class="na">inputText</span><span class="p">(),</span>
                        <span class="s1">&#39;required&#39;</span>      <span class="o">=&gt;</span> <span class="k">true</span>
                <span class="p">];</span>
        <span class="p">}</span>

        <span class="k">function</span> <span class="nf">phoneField</span><span class="p">()</span> <span class="p">{</span>
                <span class="k">return</span> <span class="p">[</span>
                        <span class="s1">&#39;name&#39;</span>          <span class="o">=&gt;</span> <span class="s1">&#39;phone&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;placeholder&#39;</span>   <span class="o">=&gt;</span> <span class="s1">&#39;Phone&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;display&#39;</span>       <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">field</span><span class="o">-&gt;</span><span class="na">inputText</span><span class="p">(),</span>
                        <span class="s1">&#39;required&#39;</span>      <span class="o">=&gt;</span> <span class="k">true</span>
                <span class="p">];</span>
        <span class="p">}</span>

        <span class="k">function</span> <span class="nf">emailField</span><span class="p">()</span> <span class="p">{</span>
                <span class="k">return</span> <span class="p">[</span>
                        <span class="s1">&#39;name&#39;</span>          <span class="o">=&gt;</span> <span class="s1">&#39;email&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;placeholder&#39;</span>           <span class="o">=&gt;</span> <span class="s1">&#39;Email Address&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;display&#39;</span>       <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">field</span><span class="o">-&gt;</span><span class="na">inputText</span><span class="p">(),</span>
                        <span class="s1">&#39;required&#39;</span>      <span class="o">=&gt;</span> <span class="k">true</span>
                <span class="p">];</span>
        <span class="p">}</span>

        <span class="k">function</span> <span class="nf">messageField</span><span class="p">()</span> <span class="p">{</span>
                <span class="k">return</span> <span class="p">[</span>
                        <span class="s1">&#39;name&#39;</span>          <span class="o">=&gt;</span> <span class="s1">&#39;message&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;placeholder&#39;</span>           <span class="o">=&gt;</span> <span class="s1">&#39;Enter your message here&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;display&#39;</span>       <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">field</span><span class="o">-&gt;</span><span class="na">textarea</span><span class="p">(),</span>
                        <span class="s1">&#39;required&#39;</span>      <span class="o">=&gt;</span> <span class="k">true</span>
                <span class="p">];</span>
        <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>It&#8217;s possible to define custom callbacks for validation and data sanitization.</p>
<p>Under the hood, the system takes information like this, and uses it to form a JSON array of field types that populates a partial.</p>
<p>Note, in the partial below, the form has an attribute set: data-xhr=&#8221;true&#8221;</p>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;h2</span> <span class="na">class=</span><span class="s">&quot;ui dividing header&quot;</span><span class="nt">&gt;</span>Contact Form<span class="nt">&lt;/h2&gt;</span>

<span class="nt">&lt;form</span> <span class="na">class=</span><span class="s">&quot;ui form segment&quot;</span> <span class="na">data-xhr=</span><span class="s">&quot;true&quot;</span> <span class="na">data-marker=</span><span class="s">&quot;contact&quot;</span> <span class="na">method=</span><span class="s">&quot;post&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;ui warning message&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;header&quot;</span><span class="nt">&gt;</span>There was a problem<span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">&quot;list&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;/ul&gt;</span>
    <span class="nt">&lt;/div&gt;</span>

    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;field&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;label&gt;</span>First Name<span class="nt">&lt;/label&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;ui left labeled input&quot;</span><span class="nt">&gt;</span>
            {{{first_name}}}
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;ui corner label&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;i</span> <span class="na">class=</span><span class="s">&quot;icon asterisk&quot;</span><span class="nt">&gt;&lt;/i&gt;</span>
            <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>

    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;field&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;label&gt;</span>Last Name<span class="nt">&lt;/label&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;ui left labeled input&quot;</span><span class="nt">&gt;</span>
            {{{last_name}}}
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;ui corner label&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;i</span> <span class="na">class=</span><span class="s">&quot;icon asterisk&quot;</span><span class="nt">&gt;&lt;/i&gt;</span>
            <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>

    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;field&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;label&gt;</span>Phone<span class="nt">&lt;/label&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;ui left labeled input&quot;</span><span class="nt">&gt;</span>
            {{{phone}}}
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;ui corner label&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;i</span> <span class="na">class=</span><span class="s">&quot;icon asterisk&quot;</span><span class="nt">&gt;&lt;/i&gt;</span>
            <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>

    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;field&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;label&gt;</span>Email<span class="nt">&lt;/label&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;ui left labeled input&quot;</span><span class="nt">&gt;</span>
            {{{email}}}
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;ui corner label&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;i</span> <span class="na">class=</span><span class="s">&quot;icon asterisk&quot;</span><span class="nt">&gt;&lt;/i&gt;</span>
            <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>

    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;field&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;label&gt;</span>Message<span class="nt">&lt;/label&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;ui left labeled input&quot;</span><span class="nt">&gt;</span>
            {{{message}}}
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;ui corner label&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;i</span> <span class="na">class=</span><span class="s">&quot;icon asterisk&quot;</span><span class="nt">&gt;&lt;/i&gt;</span>
            <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
    {{{id}}}
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;submit&quot;</span> <span class="na">class=</span><span class="s">&quot;ui blue submit button&quot;</span> <span class="na">value=</span><span class="s">&quot;Submit Contact Form&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</pre></div>
</div>
<p>A partial like that could be rendered into a layout like this:</p>
<div class="highlight-html"><div class="highlight"><pre><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
    <span class="nt">&lt;head&gt;</span>
        <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">&quot;utf-8&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;title&gt;</span>{{page_title}}<span class="nt">&lt;/title&gt;</span>
        <span class="nt">&lt;link</span> <span class="na">href=</span><span class="s">&quot;/semantic-ui/css/semantic.min.css&quot;</span> <span class="na">rel=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">type=</span><span class="s">&quot;text/css&quot;</span> <span class="na">media=</span><span class="s">&quot;all&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;/js/jquery.min.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
        <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;/js/jquery.form.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
        <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;/js/formXHR.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
        <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;/js/formHelperSemantic.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="nt">&lt;/head&gt;</span>
    <span class="nt">&lt;body</span> <span class="na">id=</span><span class="s">&quot;example&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;main container&quot;</span> <span class="na">style=</span><span class="s">&quot;width: 1200px; margin: auto&quot;</span><span class="nt">&gt;</span>
            {{{contact}}}
        <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div>
</div>
<p>The system will then handle all the business and display logic of handling errors and saving the data in the database.</p>
</div>
<div class="section" id="pubsub">
<span id="id2"></span><h2>PubSub<a class="headerlink" href="#pubsub" title="Permalink to this headline">¶</a></h2>
<p>Fork on github here: <a class="reference external" href="https://github.com/virtuecenter/pubsub">form source</a></p>
<p>The PubSub pattern is a great way to separate components in a highly decoupled manner.  In the form above, there is no logic for saving data in the database.  All the form component does, is publish a &#8220;topic&#8221; with the data attached, and if there is a subscriber to the topic the data would get saved.  In theory, there could be multiple subscribers, one for sending and email, one for logging the data, andother for indexing it in the search engine &#8211; any number of subscribers can listen to a single topic.</p>
<p>First, the subscriptions, in YAML format:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">topics</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">form-contact-save</span><span class="p-Indicator">:</span>
       <span class="l-Scalar-Plain">PostToDB</span><span class="p-Indicator">:</span> <span class="p-Indicator">[</span><span class="s">&#39;post&#39;</span><span class="p-Indicator">,</span> <span class="s">&#39;db&#39;</span><span class="p-Indicator">]</span>
</pre></div>
</div>
<p>You can see in the example above, the topic is &#8220;form-contact-save&#8221;.</p>
<p>The PostToDB subscriber is specifying that it wants to receive the &#8220;post&#8221; and &#8220;db&#8221; services from the dependency injection container.</p>
<p>Also, all subscibers receive as their first argument, the &#8220;event&#8221; which is an array containing contextual information... such as the data to save.</p>
<p>Here is the subscriber that stores data in the database that is published when forms are submitted:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>
<span class="k">return</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$event</span><span class="p">,</span> <span class="nv">$post</span><span class="p">,</span> <span class="nv">$db</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$event</span><span class="p">[</span><span class="s1">&#39;dbURI&#39;</span><span class="p">])</span> <span class="o">||</span> <span class="k">empty</span><span class="p">(</span><span class="nv">$event</span><span class="p">[</span><span class="s1">&#39;dbURI&#39;</span><span class="p">]))</span> <span class="p">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nx">\Exception</span><span class="p">(</span><span class="s1">&#39;Event does not contain a dbURI&#39;</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$event</span><span class="p">[</span><span class="s1">&#39;formMarker&#39;</span><span class="p">]))</span> <span class="p">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nx">\Exception</span><span class="p">(</span><span class="s1">&#39;Form marker not set in post&#39;</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nv">$document</span> <span class="o">=</span> <span class="nv">$post</span><span class="o">-&gt;</span><span class="p">{</span><span class="nv">$event</span><span class="p">[</span><span class="s1">&#39;formMarker&#39;</span><span class="p">]};</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$document</span> <span class="o">===</span> <span class="k">false</span> <span class="o">||</span> <span class="k">empty</span><span class="p">(</span><span class="nv">$document</span><span class="p">))</span> <span class="p">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nx">\Exception</span><span class="p">(</span><span class="s1">&#39;Document not found in post&#39;</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nv">$documentObject</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">documentStage</span><span class="p">(</span><span class="nv">$event</span><span class="p">[</span><span class="s1">&#39;dbURI&#39;</span><span class="p">],</span> <span class="nv">$document</span><span class="p">);</span>
        <span class="nv">$documentObject</span><span class="o">-&gt;</span><span class="na">upsert</span><span class="p">();</span>
        <span class="nv">$post</span><span class="o">-&gt;</span><span class="na">statusSaved</span><span class="p">();</span>
<span class="p">};</span>
</pre></div>
</div>
<hr class="docutils" />
</div>
<div class="section" id="separation">
<span id="id4"></span><h2>Separation<a class="headerlink" href="#separation" title="Permalink to this headline">¶</a></h2>
<p>Fork on github here: <a class="reference external" href="https://github.com/virtuecenter/separation">separation source</a></p>
<p>Separation is a way to bind the data returned from a RESTful API to a &#8220;partial&#8221; template that will render the data into a complete page &#8220;layout&#8221;.</p>
<p>FMF uses separation under-the-hood for rendering collections and forms.  Here is a simple example for how it may be used for rendering a homepage:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="x">$this-&gt;separation-&gt;layout(&#39;home&#39;)-&gt;template()-&gt;write();</span>
</pre></div>
</div>
<p>In the above example, it will load the &#8220;public/layouts/home.html&#8221; layout file.</p>
<p>Then, it calls the template() function which is intended as a verb in this instance, like &#8220;template this layout&#8221;.</p>
<p>And, then, it calls the &#8220;write()&#8221; method to output the merged logic.</p>
<p>Below is the YAML file for the contact form.  It would use the layout and template specified above to bring all the &#8220;separate&#8221; aspects together.</p>
<p>The config file is concerned with:</p>
<ul class="simple">
<li>the id of the section in the layout to populate markup into, in this example: contact, header and footer</li>
<li>a RESTful API &#8220;url&#8221;</li>
<li>&#8220;args&#8221; to pass to the data URL</li>
<li>a &#8220;partial&#8221; template to render the data with</li>
<li>a built in &#8220;type&#8221; for type-specific rendering logics</li>
</ul>
<div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">js</span><span class="p-Indicator">:</span>

<span class="l-Scalar-Plain">binding</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">contact</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">url</span><span class="p-Indicator">:</span> <span class="s">&#39;%dataAPI%/json-form/contact&#39;</span>
        <span class="l-Scalar-Plain">args</span><span class="p-Indicator">:</span> <span class="p-Indicator">[]</span>
        <span class="l-Scalar-Plain">partial</span><span class="p-Indicator">:</span> <span class="s">&#39;form-contact.hbs&#39;</span>
        <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="s">&quot;Form&quot;</span>
    <span class="l-Scalar-Plain">header</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">url</span><span class="p-Indicator">:</span> <span class="s">&quot;%dataAPI%/header&quot;</span>
        <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="s">&quot;html&quot;</span>
    <span class="l-Scalar-Plain">footer</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">url</span><span class="p-Indicator">:</span> <span class="s">&quot;%dataAPI%/footer&quot;</span>
        <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="s">&quot;html&quot;</span>
</pre></div>
</div>
</div>
</div>


        </div>

        <hr class="docutils" style="margin-top: 60px">
        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'fmfdoc'; // required: replace example with your forum shortname

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>

      </div>
    </section>

    
  </div>
</body>
</html>